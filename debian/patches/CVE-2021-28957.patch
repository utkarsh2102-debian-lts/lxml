Description: Add HTML-5 "formaction" attribute to "defs.link_attrs" (GH-316)
             Resolves https://bugs.launchpad.net/lxml/+bug/1888153
             See https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28957
Index: lxml-3.7.1/src/lxml/html/defs.py
===================================================================
--- lxml-3.7.1.orig/src/lxml/html/defs.py	2021-03-24 10:04:19.548882217 +0100
+++ lxml-3.7.1/src/lxml/html/defs.py	2021-03-24 10:04:19.544882140 +0100
@@ -27,6 +27,8 @@
     'usemap',
     # Not standard:
     'dynsrc', 'lowsrc',
+    # HTML5 formaction
+    'formaction'
     ])
 
 # Not in the HTML 4 spec:
Index: lxml-3.7.1/src/lxml/html/tests/test_clean.py
===================================================================
--- lxml-3.7.1.orig/src/lxml/html/tests/test_clean.py	2021-03-24 10:04:19.548882217 +0100
+++ lxml-3.7.1/src/lxml/html/tests/test_clean.py	2021-03-24 10:04:19.544882140 +0100
@@ -89,6 +89,21 @@
             b'<math><style>/* deleted */</style></math>',
             lxml.html.tostring(clean_html(s)))
 
+    def test_formaction_attribute_in_button_input(self):
+        # The formaction attribute overrides the form's action and should be
+        # treated as a malicious link attribute
+        html = ('<form id="test"><input type="submit" formaction="javascript:alert(1)"></form>'
+        '<button form="test" formaction="javascript:alert(1)">X</button>')
+        expected = ('<div><form id="test"><input type="submit" formaction=""></form>'
+        '<button form="test" formaction="">X</button></div>')
+        cleaner = Cleaner(
+            forms=False,
+            safe_attrs_only=False,
+        )
+        self.assertEqual(
+            expected,
+            cleaner.clean_html(html))
+
 
 def test_suite():
     suite = unittest.TestSuite()
